<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ALL IN THE MIND</title>

<style>
/* ===== SIMPLE AESTHETIC THEME ===== */
body {
  font-family: "Inter", Arial, sans-serif;
  background: #f5f6fa;
  color: #2c2c2c;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

h1, h2 {
  text-align: center;
  font-weight: 600;
}

/* ===== MEMBERS ===== */
#members {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin: 15px 0;
  width: 90%;
  max-width: 520px;
}

.member {
  padding: 10px 16px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 0.9em;
  background: #ffffff;
  border: 1px solid #e0e0e0;
  transition: 0.2s ease;
  display: flex;
  align-items: center;
  gap: 6px;
}

.member:hover {
  transform: translateY(-2px);
}

.member.active {
  background: #2d6cdf;
  color: white;
  border-color: #2d6cdf;
}

/* Small pending count */
.badge {
  font-size: 0.7em;
  padding: 2px 6px;
  border-radius: 10px;
  background: #f1c40f;
  color: #333;
  font-weight: 600;
}

/* ===== PROGRESS ===== */
#progress {
  font-size: 0.9em;
  margin-bottom: 10px;
  color: #555;
}

/* ===== TASK SECTION ===== */
#taskSection {
  width: 95%;
  max-width: 600px;
  background: #ffffff;
  padding: 22px;
  border-radius: 16px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  margin-bottom: 40px;
}

#newTaskInput {
  width: 100%;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 10px;
  border: 1px solid #ddd;
}

#addTaskBtn {
  width: 100%;
  padding: 12px;
  background: #2d6cdf;
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
}

/* ===== TASK LIST ===== */
ul#taskList {
  list-style: none;
  padding: 0;
  margin-top: 15px;
}

ul#taskList li {
  padding: 14px;
  background: #f9f9f9;
  border-radius: 12px;
  margin-bottom: 10px;
  border: 1px solid #eee;
}

ul#taskList li.completed {
  background: #e9f7ef;
  color: #2e7d32;
}

.task-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
}

.task-text {
  flex-grow: 1;
  margin-right: 10px;
}

/* Status labels */
.status {
  font-size: 0.75em;
  font-weight: 700;
  margin-right: 10px;
}

.status.completed {
  color: #2e7d32;
}

.status.pending {
  color: #f1c40f;
}

button.completeBtn {
  background: #2ecc71;
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
}

button.deleteBtn {
  background: #e74c3c;
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
}

/* ===== DARK TOGGLE ===== */
#darkToggle {
  position: fixed;
  top: 14px;
  right: 14px;
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
}

/* ===== DARK MODE STYLES ===== */
body.dark {
  background: #121212;
  color: #f1f1f1;
}

body.dark #taskSection,
body.dark .member {
  background: #1e1e1e;
  border-color: #333;
}

body.dark ul#taskList li {
  background: #2a2a2a;
  border-color: #333;
}

body.dark #newTaskInput {
  background: #2a2a2a;
  color: #f1f1f1;
  border-color: #444;
}

body.dark .member.active {
  background: #2d6cdf;
  color: white;
}
</style>
</head>

<body>

<button id="darkToggle">ðŸŒ™</button>

<h1>Team Task Tracker</h1>

<div id="members">
  <div class="member" data-member="Meca">Meca</div>
  <div class="member" data-member="Johny">Johny</div>
  <div class="member" data-member="Jerome">Jerome</div>
  <div class="member" data-member="Carl">Carl</div>
  <div class="member" data-member="Shawn">Shawn</div>
  <div class="member" data-member="Jomar">Jomar</div>
  <div class="member" data-member="Yvone">Yvone</div>
</div>

<div id="progress"></div>

<section id="taskSection" style="display:none;">
  <h2 id="memberTitle"></h2>
  <input type="text" id="newTaskInput" placeholder="Enter new task..." />
  <button id="addTaskBtn">Add Task</button>
  <ul id="taskList"></ul>
</section>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

<script>
 // ===== Firebase =====
 firebase.initializeApp({
   apiKey: "AIzaSyCtVN-UVUnzxbpkkMgGiNeuchhe5269qQM",
   authDomain: "teamtasktracker-d2c06.firebaseapp.com",
   projectId: "teamtasktracker-d2c06"
 });
 const db = firebase.firestore();

 // ===== Variables =====
 let selectedMember = null;
 let data = {};
 const members = ["Meca","Johny","Jerome","Carl","Shawn","Jomar","Yvone"];

 const membersDiv = document.getElementById("members");
 const taskSection = document.getElementById("taskSection");
 const memberTitle = document.getElementById("memberTitle");
 const newTaskInput = document.getElementById("newTaskInput");
 const addTaskBtn = document.getElementById("addTaskBtn");
 const taskList = document.getElementById("taskList");
 const progressDiv = document.getElementById("progress");

 // ===== Dark Mode Toggle (FIXED) =====
 const darkToggle = document.getElementById("darkToggle");

 // Load saved mode
 if (localStorage.getItem("darkMode") === "true") {
   document.body.classList.add("dark");
   darkToggle.textContent = "â˜€ï¸";
 }

 // Toggle mode
 darkToggle.onclick = () => {
   document.body.classList.toggle("dark");
   const isDark = document.body.classList.contains("dark");
   localStorage.setItem("darkMode", isDark);
   darkToggle.textContent = isDark ? "â˜€ï¸" : "ðŸŒ™";
 };

 // ===== Load / Save =====
 async function loadAllTasks(){
   const snap = await db.collection("tasks").get();
   data = {};
   snap.forEach(d => data[d.id] = d.data().tasks || []);
   members.forEach(m => { if(!data[m]) data[m] = []; });
   renderMembers();
 }

 async function saveTasksForMember(member){
   await db.collection("tasks").doc(member).set({ tasks: data[member] });
   renderMembers();
 }

 // ===== Render Members (with pending count) =====
 function renderMembers(){
   [...membersDiv.children].forEach(div => {
     const name = div.dataset.member;
     div.classList.toggle("active", name === selectedMember);

     const pending = data[name]?.filter(t => !t.completed).length || 0;
     div.innerHTML = name + (pending ? ` <span class="badge">${pending}</span>` : "");
   });
 }

 // ===== Progress =====
 function renderProgress(){
   if(!selectedMember) return progressDiv.textContent="";
   const total = data[selectedMember].length;
   const completed = data[selectedMember].filter(t=>t.completed).length;
   const percent = total ? Math.round(completed/total*100) : 0;
   progressDiv.textContent = `Progress: ${completed}/${total} (${percent}%)`;
 }

 // ===== Render Tasks =====
 function renderTasks(){
   taskList.innerHTML = "";
   if(!selectedMember) return taskSection.style.display="none";
   taskSection.style.display="block";
   memberTitle.textContent = selectedMember + "'s Tasks";
   renderProgress();

   data[selectedMember].forEach((task,i)=>{
     const li = document.createElement("li");
     if(task.completed) li.classList.add("completed");

     const row = document.createElement("div");
     row.className = "task-row";

     const text = document.createElement("span");
     text.className = "task-text";
     text.textContent = task.text;
     row.appendChild(text);

     const status = document.createElement("span");
     status.className = "status " + (task.completed ? "completed" : "pending");
     status.textContent = task.completed ? "COMPLETED" : "PENDING";
     row.appendChild(status);

     if(!task.completed){
       const completeBtn = document.createElement("button");
       completeBtn.className="completeBtn";
       completeBtn.textContent="Complete";
       completeBtn.onclick = async ()=>{
         task.completed = true;
         await saveTasksForMember(selectedMember);
         renderTasks();
         confetti();
       };
       row.appendChild(completeBtn);
     }

     const deleteBtn = document.createElement("button");
     deleteBtn.className="deleteBtn";
     deleteBtn.textContent="Remove";
     deleteBtn.onclick = async ()=>{
       data[selectedMember].splice(i,1);
       await saveTasksForMember(selectedMember);
       renderTasks();
     };

     row.appendChild(deleteBtn);
     li.appendChild(row);
     taskList.appendChild(li);
   });
 }

 // ===== Add Task =====
 addTaskBtn.onclick = async ()=>{
   if(!newTaskInput.value.trim()) return;
   data[selectedMember].push({ text:newTaskInput.value, completed:false });
   newTaskInput.value="";
   await saveTasksForMember(selectedMember);
   renderTasks();
 };

 // ===== Select Member =====
 membersDiv.onclick = async e=>{
   if(!e.target.closest(".member")) return;
   selectedMember = e.target.closest(".member").dataset.member;
   await loadAllTasks();
   renderTasks();
 };

 window.onload = loadAllTasks;
</script>

</body>
</html>
