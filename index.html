<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ALL IN THE MIND</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f7f7f7;
    margin: 0; padding: 0;
    display: flex; flex-direction: column; align-items: center;
  }
  h1 {
    margin-top: 10px;
  }
  #members {
    display: flex;
    gap: 10px;
    margin: 20px 0;
  }
  .member {
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    color: white;
    user-select: none;
    opacity: 0.7;
    transition: opacity 0.3s;
  }
  .member.active, .member:hover {
    opacity: 1;
    font-weight: bold;
  }
  /* Member colors */
  .member.meca { background: #9b59b6; } /* purple-pink */
  .member.johny { background: #27ae60; } /* green */
  .member.jerome { background: #2980b9; } /* blue */
  .member.carl { background: #7f8c8d; } /* gray */
  .member.shawn { background: #f1c40f; color: #333; } /* yellow, darker text */
  .member.jomar { background: #d35400; } /* orange-ish for variety */

  #taskSection {
    width: 90%;
    max-width: 600px;
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 8px #ccc;
  }
  #taskSection h2 {
    margin-top: 0;
    margin-bottom: 10px;
  }
  #newTaskInput {
    width: 70%;
    padding: 8px;
    font-size: 1em;
    border: 1px solid #ccc;
    border-radius: 6px;
  }
  #addTaskBtn {
    padding: 8px 14px;
    font-size: 1em;
    margin-left: 8px;
    cursor: pointer;
    border: none;
    background-color: #3498db;
    color: white;
    border-radius: 6px;
    transition: background-color 0.3s;
  }
  #addTaskBtn:hover {
    background-color: #2980b9;
  }
  ul#taskList {
    list-style: none;
    padding: 0;
    margin-top: 20px;
  }
  ul#taskList li {
    padding: 10px;
    margin-bottom: 8px;
    background: #ecf0f1;
    border-radius: 6px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #333;
  }
  ul#taskList li.completed {
    background: #d5f5e3;
    color: #27ae60;
    font-weight: bold;
  }
  .task-text {
    flex-grow: 1;
    margin-right: 10px;
  }
  .status {
    font-weight: bold;
    color: #27ae60;
    margin-left: 8px;
  }
  button.completeBtn {
    background: #27ae60;
    border: none;
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
    margin-right: 8px;
    transition: background-color 0.3s;
  }
  button.completeBtn:hover {
    background: #1e8449;
  }
  button.deleteBtn {
    background: #e74c3c;
    border: none;
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  button.deleteBtn:hover {
    background: #c0392b;
  }
  /* Confetti canvas */
  #confetti-canvas {
    position: fixed;
    pointer-events: none;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 9999;
  }
</style>
</head>
<body>

<h1>Team Task Tracker</h1>

<div id="members">
  <div class="member meca" data-member="Meca">Meca</div>
  <div class="member johny" data-member="Johny">Johny</div>
  <div class="member jerome" data-member="Jerome">Jerome</div>
  <div class="member carl" data-member="Carl">Carl</div>
  <div class="member shawn" data-member="Shawn">Shawn</div>
  <div class="member jomar" data-member="Jomar">Jomar</div>
</div>

<section id="taskSection" style="display:none;">
  <h2 id="memberTitle"></h2>
  <input type="text" id="newTaskInput" placeholder="Enter new task..." />
  <button id="addTaskBtn">Add Task</button>

  <ul id="taskList"></ul>
</section>

<canvas id="confetti-canvas"></canvas>

<!-- Firebase scripts -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

<script>
// ===== Paste your Firebase config here =====
const firebaseConfig = {
  apiKey: "AIzaSyCtVN-UVUnzxbpkkMgGiNeuchhe5269qQM",
  authDomain: "teamtasktracker-d2c06.firebaseapp.com",
  projectId: "teamtasktracker-d2c06",
  storageBucket: "teamtasktracker-d2c06.firebasestorage.app",
  messagingSenderId: "1030000534391",
  appId: "1:1030000534391:web:9e7266bd8979b98351f772"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let selectedMember = null;
let data = {}; // { memberName: [ {text, completed} ] }

const members = ["Meca", "Johny", "Jerome", "Carl", "Shawn", "Jomar"];

const membersDiv = document.getElementById("members");
const taskSection = document.getElementById("taskSection");
const memberTitle = document.getElementById("memberTitle");
const newTaskInput = document.getElementById("newTaskInput");
const addTaskBtn = document.getElementById("addTaskBtn");
const taskList = document.getElementById("taskList");

function showConfetti() {
  const duration = 3 * 1000;
  const end = Date.now() + duration;

  (function frame() {
    // create confetti with Canvas Confetti library
    confetti({
      particleCount: 5,
      spread: 70,
      origin: { y: 0.6 }
    });
    if (Date.now() < end) {
      requestAnimationFrame(frame);
    }
  })();
}

// Load tasks for all members from Firestore
async function loadAllTasks() {
  const snapshot = await db.collection("tasks").get();
  data = {};
  snapshot.forEach(doc => {
    data[doc.id] = doc.data().tasks || [];
  });

  // Initialize empty arrays for any members not found in Firestore
  members.forEach(m => {
    if (!data[m]) data[m] = [];
  });
}

// Save tasks for one member to Firestore
async function saveTasksForMember(member) {
  if (!member) return;
  await db.collection("tasks").doc(member).set({
    tasks: data[member] || []
  });
}

// Render member list with active class
function renderMembers() {
  Array.from(membersDiv.children).forEach(div => {
    if (div.dataset.member === selectedMember) {
      div.classList.add("active");
    } else {
      div.classList.remove("active");
    }
  });
}

// Render task list for selected member
function renderTasks() {
  taskList.innerHTML = "";
  if (!selectedMember) {
    taskSection.style.display = "none";
    return;
  }
  taskSection.style.display = "block";
  memberTitle.textContent = selectedMember + "'s Tasks";

  const tasks = data[selectedMember] || [];

  tasks.forEach((task, index) => {
    const li = document.createElement("li");
    li.className = task.completed ? "completed" : "";
    const spanText = document.createElement("span");
    spanText.textContent = task.text;
    spanText.className = "task-text";
    li.appendChild(spanText);

    if (task.completed) {
      const completedLabel = document.createElement("span");
      completedLabel.textContent = "COMPLETED";
      completedLabel.className = "status";
      li.appendChild(completedLabel);
    }

    // Complete button
    if (!task.completed) {
      const completeBtn = document.createElement("button");
      completeBtn.textContent = "Complete";
      completeBtn.className = "completeBtn";
      completeBtn.onclick = async () => {
        data[selectedMember][index].completed = true;
        await saveTasksForMember(selectedMember);
        renderTasks();
        showConfetti();
      };
      li.appendChild(completeBtn);
    }

    // Delete button
    const deleteBtn = document.createElement("button");
    deleteBtn.textContent = "Remove";
    deleteBtn.className = "deleteBtn";
    deleteBtn.onclick = async () => {
      data[selectedMember].splice(index, 1);
      await saveTasksForMember(selectedMember);
      renderTasks();
    };
    li.appendChild(deleteBtn);

    taskList.appendChild(li);
  });
}

// Add new task
addTaskBtn.addEventListener("click", async () => {
  const taskText = newTaskInput.value.trim();
  if (!taskText) return;
  data[selectedMember].push({ text: taskText, completed: false });
  newTaskInput.value = "";
  await saveTasksForMember(selectedMember);
  renderTasks();
});

// Select member
membersDiv.addEventListener("click", async (e) => {
  if (!e.target.classList.contains("member")) return;
  selectedMember = e.target.dataset.member;
  await loadAllTasks();
  renderMembers();
  renderTasks();
});

// Load all tasks on startup but donâ€™t show until member selected
window.addEventListener("load", async () => {
  await loadAllTasks();
});
</script>

<!-- Confetti library -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

</body>
</html>


